# Трассировка

Алгоритм трассировки заключен в следующем коде:

```C++
size_t nedges = 1;
edges[0] = c;

do {
    nedges--;
    const int t = edges[nedges];

    int nbs[8]; // neighbours
    nbs[0] = t - nx;     // nn
    nbs[1] = t + nx;     // ss
    nbs[2] = t + 1;      // ww
    nbs[3] = t - 1;      // ee
    nbs[4] = nbs[0] + 1; // nw
    nbs[5] = nbs[0] - 1; // ne
    nbs[6] = nbs[1] + 1; // sw
    nbs[7] = nbs[1] - 1; // se

    for (size_t k = 0; k < 8; k++)
	if (nms[nbs[k]] >= tMin && out[nbs[k]] == 0) {
	    out[nbs[k]] = PixelsMatrix::MAX_BRIGHTNESS;
	    edges[nedges] = nbs[k];
	    nedges++;
	}
} while (nedges > 0);
```
Алгоритм использует стек индексов матрицы. В программе он реализован как индексный массив `edges`
и переменная `nedges` обозначающая индекс вершины стека.

В начале алгоритма трассировки на стек кладется текущий индекс в матрице 
(это индекс для которого значение элемента матрицы больше верхнего порога фильтрации).
Соответственно вершина стека `nedges` становиться равной 1.

Далее в цикле пока стек не опустеет выполняются следующие действия:
1. Извлекается верхний элемент стека, что приводит к его уменьшению на 1.
2. Находятся 8 соседних индексов от индекса извлеченного со стека.
3. Для всех соседних индексов проверяется, если значение матрицы в этом индексе больше минимального порога фильтрации
  и он ранее не был помечен как прошедший, то он помечается как прошедший индекс и кладется на вершину стека.
